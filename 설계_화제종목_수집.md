# ì˜¤ëŠ˜ì˜ í™”ì œ ì¢…ëª© ìˆ˜ì§‘ ì„¤ê³„

## 1. ë°ì´í„° ì†ŒìŠ¤ ì¥ë‹¨ì  ë¹„êµ

### 1.1 yahooquery Screener (Yahoo Finance)

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë°ì´í„° ì¢…ë¥˜** | most_actives (ê±°ë˜ëŸ‰), day_gainers (ìƒìŠ¹ë¥ ), day_losers (í•˜ë½ë¥ ) |
| **ì¥ì ** | ë¬´ë£Œ, ì‹¤ì‹œê°„ ë°ì´í„°, ì•ˆì •ì ì¸ API, ë³„ë„ ì¸ì¦ ë¶ˆí•„ìš”, ê°ê´€ì  ìˆ˜ì¹˜ ê¸°ë°˜ |
| **ë‹¨ì ** | ë‹¨ìˆœ ìˆ˜ì¹˜ ê¸°ë°˜ (ì‹œì¥ ê´€ì‹¬ë„/í™”ì œì„± ë°˜ì˜ ì•ˆë¨), Rate Limit ì¡´ì¬ |
| **ì‹ ë¢°ë„** | â­â­â­â­â­ (ê³µì‹ ê¸ˆìœµ ë°ì´í„°) |
| **ì í•©ì„±** | âœ… í”„ë¡œë•ì…˜ ì‚¬ìš© ì í•© |

### 1.2 ApeWisdom (apewisdom.io)

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë°ì´í„° ì¢…ë¥˜** | Reddit WSB 24ì‹œê°„ ë©˜ì…˜ ìˆœìœ„, ê°ì„± ë¶„ì„ |
| **ì¥ì ** | ì†Œì…œ í™”ì œì„± ë°˜ì˜, ê°œì¸íˆ¬ìì ê´€ì‹¬ ì¢…ëª© íŒŒì•… ê°€ëŠ¥ |
| **ë‹¨ì ** | ë¹„ê³µì‹ API, ì•ˆì •ì„± ë³´ì¥ ì•ˆë¨, WSB í¸í–¥ (ë°ˆì£¼ì‹ ê³¼ëŒ€ëŒ€í‘œ) |
| **ì‹ ë¢°ë„** | â­â­â­ (ì»¤ë®¤ë‹ˆí‹° ë°ì´í„°) |
| **ì í•©ì„±** | âš ï¸ ì°¸ê³ ìš©ìœ¼ë¡œë§Œ ì‚¬ìš© ê¶Œì¥ |

### 1.3 SwaggyStocks

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ë°ì´í„° ì¢…ë¥˜** | WSB ì‹¤ì‹œê°„ ê°ì„± ë¶„ì„, ì˜µì…˜ í”Œë¡œìš° |
| **ì¥ì ** | ê°ì„± ì§€í‘œ í¬í•¨, ì‹œê°í™” ì œê³µ |
| **ë‹¨ì ** | ìœ ë£Œ ê¸°ëŠ¥ ë‹¤ìˆ˜, API ì œê³µ ë¶ˆì•ˆì •, ì„œë¹„ìŠ¤ ì§€ì†ì„± ë¶ˆí™•ì‹¤ |
| **ì‹ ë¢°ë„** | â­â­ (ì„œë“œíŒŒí‹° ì„œë¹„ìŠ¤) |
| **ì í•©ì„±** | âŒ ìë™í™” ì„œë¹„ìŠ¤ì— ë¶€ì í•© |

### ë¹„êµ ìš”ì•½

| ì†ŒìŠ¤ | ì•ˆì •ì„± | ë¬´ë£Œ | ê°ê´€ì„± | í™”ì œì„± | ìë™í™” ì í•© |
|------|--------|------|--------|--------|-------------|
| yahooquery | â­â­â­â­â­ | âœ… | â­â­â­â­â­ | â­â­â­ | âœ… |
| ApeWisdom | â­â­â­ | âœ… | â­â­ | â­â­â­â­â­ | âš ï¸ |
| SwaggyStocks | â­â­ | âŒ | â­â­â­ | â­â­â­â­ | âŒ |

---

## 2. ê¶Œì¥ ë°ì´í„° ì†ŒìŠ¤ ì„ ì •

### âœ… ê¶Œì¥: yahooquery Screener (most_actives + day_gainers ì¡°í•©)

**ì„ ì • ê·¼ê±°:**

1. **ì•ˆì •ì„±**: Yahoo FinanceëŠ” ê¸€ë¡œë²Œ ê¸ˆìœµ ë°ì´í„° ì œê³µìë¡œ ì„œë¹„ìŠ¤ ì§€ì†ì„± ë³´ì¥
2. **ë¬´ë£Œ**: ë³„ë„ API í‚¤ë‚˜ ìœ ë£Œ êµ¬ë… ë¶ˆí•„ìš”
3. **ê°ê´€ì„±**: ê±°ë˜ëŸ‰/ìƒìŠ¹ë¥ ì€ ì¡°ì‘ ë¶ˆê°€ëŠ¥í•œ ì‹œì¥ ë°ì´í„°
4. **ë²•ì  ì•ˆì „ì„±**: ê³µê°œëœ ê¸ˆìœµ ë°ì´í„° í™œìš©ìœ¼ë¡œ ì €ì‘ê¶Œ/ì´ìš©ì•½ê´€ ë¬¸ì œ ìµœì†Œí™”
5. **ì´ˆë³´ì ì í•©**: "ë§ì´ ê±°ë˜ëœ = ê´€ì‹¬ ë§ì€" ì§ê´€ì  ê¸°ì¤€

**ì„ ì • ë¡œì§:**
```
í™”ì œ ì¢…ëª© = most_actives âˆ© day_gainers (êµì§‘í•© ìš°ì„ )
          â†’ êµì§‘í•© ì—†ìœ¼ë©´ most_actives ìƒìœ„ ì¢…ëª©
```

> ğŸ’¡ **ì„¤ê³„ ì² í•™**: "ê±°ë˜ëŸ‰ì´ ë§ìœ¼ë©´ì„œ ìƒìŠ¹í•œ ì¢…ëª©"ì´ ê°€ì¥ ê¸ì •ì ì¸ í™”ì œ ì¢…ëª©

---

## 3. yahooquery Screener ì‚¬ìš© ì½”ë“œ ì˜ˆì‹œ

### 3.1 ê¸°ë³¸ ì„¤ì¹˜

```bash
pip install yahooquery
```

### 3.2 ë°ì´í„° ìˆ˜ì§‘ ì½”ë“œ

```python
from yahooquery import Screener

def get_trending_stocks():
    """Yahoo Financeì—ì„œ í™”ì œ ì¢…ëª© ë°ì´í„° ìˆ˜ì§‘"""
    
    screener = Screener()
    
    # ê±°ë˜ëŸ‰ ìƒìœ„ ì¢…ëª©
    most_actives = screener.get_screeners('most_actives', count=25)
    
    # ìƒìŠ¹ë¥  ìƒìœ„ ì¢…ëª©
    day_gainers = screener.get_screeners('day_gainers', count=25)
    
    # í•˜ë½ë¥  ìƒìœ„ ì¢…ëª© (ì°¸ê³ ìš©)
    day_losers = screener.get_screeners('day_losers', count=25)
    
    return {
        'most_actives': most_actives,
        'day_gainers': day_gainers,
        'day_losers': day_losers
    }


def parse_screener_data(screener_result, screener_name):
    """Screener ê²°ê³¼ë¥¼ íŒŒì‹±í•˜ì—¬ ì¢…ëª© ë¦¬ìŠ¤íŠ¸ ë°˜í™˜"""
    
    try:
        quotes = screener_result[screener_name]['quotes']
        
        stocks = []
        for quote in quotes:
            stock = {
                'symbol': quote.get('symbol'),
                'name': quote.get('shortName') or quote.get('longName'),
                'price': quote.get('regularMarketPrice'),
                'change_percent': quote.get('regularMarketChangePercent'),
                'volume': quote.get('regularMarketVolume'),
                'market_cap': quote.get('marketCap'),
            }
            stocks.append(stock)
        
        return stocks
    
    except (KeyError, TypeError) as e:
        print(f"íŒŒì‹± ì˜¤ë¥˜: {e}")
        return []


# ì‚¬ìš© ì˜ˆì‹œ
if __name__ == "__main__":
    data = get_trending_stocks()
    
    actives = parse_screener_data(data['most_actives'], 'most_actives')
    gainers = parse_screener_data(data['day_gainers'], 'day_gainers')
    
    print("=== ê±°ë˜ëŸ‰ TOP 5 ===")
    for stock in actives[:5]:
        print(f"{stock['symbol']}: {stock['name']} | ${stock['price']} | {stock['change_percent']:.2f}%")
    
    print("\n=== ìƒìŠ¹ë¥  TOP 5 ===")
    for stock in gainers[:5]:
        print(f"{stock['symbol']}: {stock['name']} | ${stock['price']} | {stock['change_percent']:.2f}%")
```

---

## 4. TOP 1 ì¢…ëª© ì„ ì • ë¡œì§

### 4.1 ì„ ì • ì•Œê³ ë¦¬ì¦˜

```python
def select_top_stock(most_actives: list, day_gainers: list) -> dict:
    """
    TOP 1 í™”ì œ ì¢…ëª© ì„ ì •
    
    ì„ ì • ìš°ì„ ìˆœìœ„:
    1. ê±°ë˜ëŸ‰ TOP 25 AND ìƒìŠ¹ë¥  TOP 25 êµì§‘í•© ì¤‘ ê±°ë˜ëŸ‰ 1ìœ„
    2. êµì§‘í•© ì—†ìœ¼ë©´ ê±°ë˜ëŸ‰ TOP 1 (ë‹¨, í•˜ë½ë¥  -5% ì´ìƒë§Œ)
    3. ëª¨ë‘ í•´ë‹¹ ì—†ìœ¼ë©´ ìƒìŠ¹ë¥  TOP 1
    """
    
    # í‹°ì»¤ ì‹¬ë³¼ ì§‘í•© ìƒì„±
    active_symbols = {s['symbol'] for s in most_actives}
    gainer_symbols = {s['symbol'] for s in day_gainers}
    
    # 1ìˆœìœ„: êµì§‘í•© (ê±°ë˜ëŸ‰ ë§ìœ¼ë©´ì„œ ìƒìŠ¹í•œ ì¢…ëª©)
    intersection = active_symbols & gainer_symbols
    
    if intersection:
        # êµì§‘í•© ì¤‘ ê±°ë˜ëŸ‰ ê¸°ì¤€ ì •ë ¬
        candidates = [s for s in most_actives if s['symbol'] in intersection]
        candidates.sort(key=lambda x: x['volume'] or 0, reverse=True)
        return {
            'stock': candidates[0],
            'selection_reason': 'ê±°ë˜ëŸ‰ ìƒìœ„ + ìƒìŠ¹ ì¢…ëª©',
            'confidence': 'HIGH'
        }
    
    # 2ìˆœìœ„: ê±°ë˜ëŸ‰ TOP 1 (ì‹¬í•œ í•˜ë½ ì œì™¸)
    for stock in most_actives:
        change = stock.get('change_percent') or 0
        if change >= -5:  # -5% ì´ìƒë§Œ í—ˆìš©
            return {
                'stock': stock,
                'selection_reason': 'ê±°ë˜ëŸ‰ 1ìœ„ (ìƒìŠ¹ ì¢…ëª© ì—†ìŒ)',
                'confidence': 'MEDIUM'
            }
    
    # 3ìˆœìœ„: ìƒìŠ¹ë¥  TOP 1
    if day_gainers:
        return {
            'stock': day_gainers[0],
            'selection_reason': 'ìƒìŠ¹ë¥  1ìœ„ (ê±°ë˜ëŸ‰ ìƒìœ„ ì—†ìŒ)',
            'confidence': 'LOW'
        }
    
    # ë°ì´í„° ì—†ìŒ
    return {
        'stock': None,
        'selection_reason': 'ì„ ì • ê°€ëŠ¥í•œ ì¢…ëª© ì—†ìŒ',
        'confidence': 'NONE'
    }
```

### 4.2 ì„ ì • í”Œë¡œìš°ì°¨íŠ¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ë°ì´í„° ìˆ˜ì§‘ (yahooquery)        â”‚
â”‚  most_actives + day_gainers ì¡°íšŒ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    êµì§‘í•© ì¡´ì¬?                      â”‚
â”‚  (ê±°ë˜ëŸ‰ TOP & ìƒìŠ¹ë¥  TOP)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         YES â”‚          â”‚ NO
             â–¼          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ êµì§‘í•© ì¤‘       â”‚  â”‚ ê±°ë˜ëŸ‰ TOP 1 ì„ íƒ       â”‚
â”‚ ê±°ë˜ëŸ‰ 1ìœ„ ì„ íƒ â”‚  â”‚ (ë³€ë™ë¥  -5% ì´ìƒë§Œ)     â”‚
â”‚ [HIGH ì‹ ë¢°ë„]  â”‚  â”‚ [MEDIUM ì‹ ë¢°ë„]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ í•´ë‹¹ ì—†ìŒ
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ ìƒìŠ¹ë¥  TOP 1 ì„ íƒ       â”‚
                    â”‚ [LOW ì‹ ë¢°ë„]           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. ì—£ì§€ ì¼€ì´ìŠ¤ ì²˜ë¦¬

### 5.1 ë°ì´í„° ì—†ìŒ ì²˜ë¦¬

```python
def get_trending_stocks_safe():
    """ì•ˆì „í•œ ë°ì´í„° ìˆ˜ì§‘ (ì—ëŸ¬ í•¸ë“¤ë§ í¬í•¨)"""
    
    import time
    
    MAX_RETRIES = 3
    RETRY_DELAY = 5  # seconds
    
    for attempt in range(MAX_RETRIES):
        try:
            screener = Screener()
            
            most_actives = screener.get_screeners('most_actives', count=25)
            day_gainers = screener.get_screeners('day_gainers', count=25)
            
            # ë°ì´í„° ìœ íš¨ì„± ê²€ì¦
            if not most_actives or 'most_actives' not in most_actives:
                raise ValueError("most_actives ë°ì´í„° ì—†ìŒ")
            
            if not day_gainers or 'day_gainers' not in day_gainers:
                raise ValueError("day_gainers ë°ì´í„° ì—†ìŒ")
            
            return {
                'success': True,
                'most_actives': most_actives,
                'day_gainers': day_gainers,
                'error': None
            }
            
        except Exception as e:
            print(f"ì‹œë„ {attempt + 1}/{MAX_RETRIES} ì‹¤íŒ¨: {e}")
            if attempt < MAX_RETRIES - 1:
                time.sleep(RETRY_DELAY)
    
    # ëª¨ë“  ì¬ì‹œë„ ì‹¤íŒ¨
    return {
        'success': False,
        'most_actives': None,
        'day_gainers': None,
        'error': 'ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨ (ìµœëŒ€ ì¬ì‹œë„ ì´ˆê³¼)'
    }
```

### 5.2 ì¤‘ë³µ ì¢…ëª© ì²˜ë¦¬

```python
def remove_duplicates(stocks: list) -> list:
    """ì¤‘ë³µ í‹°ì»¤ ì œê±° (ì²« ë²ˆì§¸ í•­ëª© ìœ ì§€)"""
    
    seen = set()
    unique_stocks = []
    
    for stock in stocks:
        symbol = stock.get('symbol')
        if symbol and symbol not in seen:
            seen.add(symbol)
            unique_stocks.append(stock)
    
    return unique_stocks
```

### 5.3 ë¹„ì •ìƒ ì¢…ëª© í•„í„°ë§

```python
def filter_valid_stocks(stocks: list) -> list:
    """ë¹„ì •ìƒ ì¢…ëª© í•„í„°ë§"""
    
    valid_stocks = []
    
    for stock in stocks:
        # í•„ìˆ˜ ë°ì´í„° ì¡´ì¬ í™•ì¸
        if not stock.get('symbol'):
            continue
        
        # ê°€ê²©ì´ 0 ì´í•˜ì¸ ì¢…ëª© ì œì™¸
        price = stock.get('price') or 0
        if price <= 0:
            continue
        
        # ê±°ë˜ëŸ‰ì´ ë„ˆë¬´ ì ì€ ì¢…ëª© ì œì™¸ (ìœ ë™ì„± ë¶€ì¡±)
        volume = stock.get('volume') or 0
        if volume < 100000:  # ìµœì†Œ 10ë§Œ ì£¼ ê±°ë˜
            continue
        
        # í˜ë‹ˆ ìŠ¤íƒ ì œì™¸ (ê°€ê²© $1 ë¯¸ë§Œ)
        if price < 1:
            continue
        
        valid_stocks.append(stock)
    
    return valid_stocks
```

### 5.4 ì‹œì¥ íœ´ì¥ì¼ ì²˜ë¦¬

```python
from datetime import datetime, timedelta
import pytz

def is_market_open_day() -> bool:
    """ë¯¸êµ­ ì‹œì¥ ê°œì¥ì¼ ì—¬ë¶€ í™•ì¸ (ê°„ë‹¨ ë²„ì „)"""
    
    # ë¯¸êµ­ ë™ë¶€ ì‹œê°„ ê¸°ì¤€
    eastern = pytz.timezone('US/Eastern')
    now = datetime.now(eastern)
    
    # ì£¼ë§ ì²´í¬
    if now.weekday() >= 5:  # í† (5), ì¼(6)
        return False
    
    # TODO: ê³µíœ´ì¼ ì²´í¬ ì¶”ê°€ í•„ìš”
    # (holidays ë¼ì´ë¸ŒëŸ¬ë¦¬ ë˜ëŠ” í•˜ë“œì½”ë”©)
    
    return True


def get_last_trading_day() -> str:
    """ë§ˆì§€ë§‰ ê±°ë˜ì¼ ë°˜í™˜"""
    
    eastern = pytz.timezone('US/Eastern')
    now = datetime.now(eastern)
    
    # ì£¼ë§ì´ë©´ ê¸ˆìš”ì¼ë¡œ
    while now.weekday() >= 5:
        now -= timedelta(days=1)
    
    return now.strftime('%Y-%m-%d')
```

### 5.5 ì „ì²´ í†µí•© ì½”ë“œ

```python
def get_top_trending_stock():
    """
    ì˜¤ëŠ˜ì˜ í™”ì œ ì¢…ëª© TOP 1 ì„ ì • (ì „ì²´ íŒŒì´í”„ë¼ì¸)
    
    Returns:
        dict: {
            'success': bool,
            'stock': dict or None,
            'selection_reason': str,
            'confidence': str,
            'timestamp': str,
            'error': str or None
        }
    """
    
    from datetime import datetime
    
    # 1. ë°ì´í„° ìˆ˜ì§‘
    data = get_trending_stocks_safe()
    
    if not data['success']:
        return {
            'success': False,
            'stock': None,
            'selection_reason': None,
            'confidence': 'NONE',
            'timestamp': datetime.now().isoformat(),
            'error': data['error']
        }
    
    # 2. ë°ì´í„° íŒŒì‹±
    most_actives = parse_screener_data(data['most_actives'], 'most_actives')
    day_gainers = parse_screener_data(data['day_gainers'], 'day_gainers')
    
    # 3. í•„í„°ë§ (ì¤‘ë³µ ì œê±° + ë¹„ì •ìƒ ì¢…ëª© ì œì™¸)
    most_actives = filter_valid_stocks(remove_duplicates(most_actives))
    day_gainers = filter_valid_stocks(remove_duplicates(day_gainers))
    
    # 4. TOP 1 ì„ ì •
    result = select_top_stock(most_actives, day_gainers)
    
    return {
        'success': result['stock'] is not None,
        'stock': result['stock'],
        'selection_reason': result['selection_reason'],
        'confidence': result['confidence'],
        'timestamp': datetime.now().isoformat(),
        'error': None if result['stock'] else 'ì„ ì • ê°€ëŠ¥í•œ ì¢…ëª© ì—†ìŒ'
    }
```

---

## 6. ìš”ì•½

| í•­ëª© | ê²°ì • |
|------|------|
| **ë°ì´í„° ì†ŒìŠ¤** | yahooquery Screener (most_actives + day_gainers) |
| **ì„ ì • ê¸°ì¤€** | ê±°ë˜ëŸ‰ ìƒìœ„ âˆ© ìƒìŠ¹ë¥  ìƒìœ„ â†’ ê±°ë˜ëŸ‰ 1ìœ„ â†’ ìƒìŠ¹ë¥  1ìœ„ |
| **í•„í„°ë§** | í˜ë‹ˆìŠ¤íƒ ì œì™¸, ìµœì†Œ ê±°ë˜ëŸ‰ 10ë§Œì£¼, ê°€ê²© $1 ì´ìƒ |
| **ì—ëŸ¬ ì²˜ë¦¬** | ìµœëŒ€ 3íšŒ ì¬ì‹œë„, 5ì´ˆ ê°„ê²© |
| **ì‹ ë¢°ë„ í‘œì‹œ** | HIGH / MEDIUM / LOW / NONE |

---

**ì‘ì„±ì¼**: 2025ë…„ 12ì›”
**ë²„ì „**: 1.0





